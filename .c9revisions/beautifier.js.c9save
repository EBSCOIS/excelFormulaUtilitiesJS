{"ts":1342443826953,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"//Beautifier.js\n//\n//Copywrite 2011 Josh Benentt\n//License - https://raw.github.com/joshatjben/excelFormulaUtilitiesJS/master/LICENSE.txt\n//[on github](https://github.com/joshatjben/excelFormulaUtilitiesJS/tree/master/examples/basic_example1 \"github\")\n//\n(function (window, undefiend) {\n    \"use strict\";\n\t\n    //Check and setup name spaces.\n\twindow.excelFormulaBeautifier = window.excelFormulaBeautifier || {};\n    window.excelFormulaBeautifier.examples = window.excelFormulaBeautifier.examples || {};\n\t\n\t//Configuration\n    //-------------------------------\n\tvar config = {\n\t\t//The ID for the formula Input input/textarea\n\t\tINPUT_ID: 'formula_input',\n\t\t\n\t\t//The ID for the formula title area. in this example it spits out the function call;\n\t\tFORMULA_TITLE_ID: 'fomatFormula_2',\n\t\t\n\t\t//THE ID for the area to contain the beautified excel formula.\n\t\tFORMULA_BODY_ID:'fomatFormula_2_out',\n\t\t\n\t\t//Use this to set the inital textare/input text area.\n\t\tDEFAULT_FORMULA: ''\n\t},\n\t\n\n    //Beautifier Page functionality\n    //-------------------------------\n\tbeautifier = window.excelFormulaBeautifier.examples.beautifier = \n\t\t(function () {\n\t\t\tvar oldFormula;\n\t\t\t\n\t\t\treturn {\n\t\t\t\tformula: '=IF(SUM( If(FOO = BAR, 10, 0), 10 ) = 20 , \"FOO\", \"BAR\")',\n\t\t\t\tinput: null,\n\t\t\t\tformulaTitle: null,\n\t\t\t\tformulaBody: null,\n                mode: \"beautify\",\n                changeMode: function(mode){\n                    window.excelFormulaBeautifier.examples.beautifier.mode = mode;\n                    window.excelFormulaBeautifier.examples.beautifier.update.call(window.excelFormulaBeautifier.examples.beautifier);\n                },\n\t\t\t\tupdate: function () {\n\t\t\t\t\tthis.formula = this.input.value;\n\n\t\t\t\t\t//Test to see if the formula has changed, if it hasn't don't do anything\n\t\t\t\t\tif (oldFormula === this.formula) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n                    \n\t\t\t\t\t// Check to see which mode we're in, render appropriately\n\t\t\t\t\ttry{\n                        \n\t\t\t\t\t\tswitch( this.mode ) {\n                            case \"beautify\":\n                                this.formulaBody.innerHTML = window.excelFormulaUtilities.formatFormulaHTML(this.formula);\n                                break;\n                            case \"js\":\n                                this.formulaBody.innerHTML = window.excelFormulaUtilities.formula2JavaScript(this.formula);\n                                break;\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(exception){\n\t\t\t\t\t\t//Do nothing, This should throw an error when the formula is improperly formed, which shouldn't blow things up.\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}());\n\n\t//On Page Load\n\t//-------------------\n\twindow.onload = function () {\n\t\tbeautifier.input = document.getElementById(config.INPUT_ID);\n\t\t//beautifier.formulaTitle = document.getElementById(config.FORMULA_TITLE_ID);\n\t\tbeautifier.formulaBody = document.getElementById(config.FORMULA_BODY_ID);\n\n\t\tbeautifier.input.value = beautifier.formula;\n\t\tbeautifier.update();\n\t\t//add beautifier.update(); here if if you have set an inital DEFAULT_FORMULA and would like it to render on page load.\n\t};\n\t\n}(window));\n"]],"start1":0,"start2":0,"length1":0,"length2":3058}]],"length":3058}
