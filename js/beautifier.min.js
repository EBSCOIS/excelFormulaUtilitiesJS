!function(){"use strict";window.addEventListener("load",function(){var e=window.document.getElementById("isEu");e.addEventListener("click",function(){window.excelFormulaUtilities.isEu=e.checked})});var e=new Clipboard("#copyFormulaBtn",{text:function(e){return document.getElementById("fomatFormula_2_out").innerHtml}});e.on("success",function(e){e.clearSelection()}),e.on("error",function(e){})}(),function(e,t){"use strict";e.excelFormulaBeautifier=e.excelFormulaBeautifier||{},e.excelFormulaBeautifier.examples=e.excelFormulaBeautifier.examples||{};var a={INPUT_ID:"formula_input",FORMULA_TITLE_ID:"fomatFormula_2",FORMULA_BODY_ID:"fomatFormula_2_out",DEFAULT_FORMULA:""},u=null,n="beautify",i=e.excelFormulaBeautifier.examples.beautifier=function(){var t;return{formula:'=IF(SUM( IF(FOO = BAR, 10, 0), 10 ) = 20 , "FOO", "BAR")',input:null,formulaTitle:null,formulaBody:null,mode:"beautify",changeMode:function(t){n=t,e.excelFormulaBeautifier.examples.beautifier.mode=t,e.excelFormulaBeautifier.examples.beautifier.update.call(e.excelFormulaBeautifier.examples.beautifier),"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Change Mode","Select",t])},formulaAreaClicked:function(){"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Formula Input","Clicked",n])},update:function(){if(this.formula=this.input.value,t!==this.formula){var a=document.getElementById("numberOfSpaces").value||4;a=Number.isNaN(Number.parseInt(a))?4:Math.min(a,10),document.getElementById("numberOfSpaces").value=a;try{switch(this.mode){case"beautify":for(var i="",r=0;r<a;r+=1)i+="&nbsp;";var l={tmplIndentTab:'<span class="tabbed">'+i+"</span>"};this.formulaBody.innerHTML=e.excelFormulaUtilities.formatFormulaHTML(this.formula,l);break;case"minify":this.formulaBody.innerHTML=this.formula.replace(/\s+/gi," ");break;case"js":this.formulaBody.innerHTML=e.excelFormulaUtilities.formula2JavaScript(this.formula);break;case"csharp":this.formulaBody.innerHTML=e.excelFormulaUtilities.formula2CSharp(this.formula);break;case"python":this.formulaBody.innerHTML=e.excelFormulaUtilities.formula2Python(this.formula)}}catch(o){}clearTimeout(u),u=setTimeout(function(){"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Formula Input","Updated",n])},1e3)}}}}();e.onload=function(){i.input=document.getElementById(a.INPUT_ID),i.formulaBody=document.getElementById(a.FORMULA_BODY_ID),i.input.value=i.formula,i.update();var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=document.getElementById("version");t.innerHTML=JSON.parse(e.responseText).version}},e.open("GET","package.json",!0),e.send()}}(window);